!function(){return function t(i,e,r){function a(n,h){if(!e[n]){if(!i[n]){var l="function"==typeof require&&require;if(!h&&l)return l(n,!0);if(s)return s(n,!0);var o=new Error("Cannot find module '"+n+"'");throw o.code="MODULE_NOT_FOUND",o}var u=e[n]={exports:{}};i[n][0].call(u.exports,function(t){return a(i[n][1][t]||t)},u,u.exports,t,i,e,r)}return e[n].exports}for(var s="function"==typeof require&&require,n=0;n<r.length;n++)a(r[n]);return a}}()({1:[function(t,i,e){"use strict";i.exports={Simple:t("./simple"),SpatialHash:t("./spatial-hash")},PIXI&&(PIXI.extras.Cull={Simple:t("./simple"),SpatialHash:t("./spatial-hash")})},{"./simple":2,"./spatial-hash":3}],2:[function(t,i,e){"use strict";var r=function(){function t(t,i){for(var e=0;e<i.length;e++){var r=i[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(i,e,r){return e&&t(i.prototype,e),r&&t(i,r),i}}();var a=function(){function t(i){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),i=i||{},this.visible=i.visible||"visible",this.calculatePIXI=void 0===i.calculatePIXI||i.calculatePIXI,this.dirtyTest=void 0===i.dirtyTest||i.dirtyTest,this.AABB=i.AABB||"AABB",this.lists=[[]]}return r(t,[{key:"addList",value:function(t,i){if(this.lists.push(t),i&&(t.staticObject=!0),this.calculatePIXI&&this.dirtyTest){var e=!0,r=!1,a=void 0;try{for(var s,n=t[Symbol.iterator]();!(e=(s=n.next()).done);e=!0){var h=s.value;this.updateObject(h)}}catch(t){r=!0,a=t}finally{try{!e&&n.return&&n.return()}finally{if(r)throw a}}}return t}},{key:"removeList",value:function(t){return this.lists.splice(this.lists.indexOf(t),1),t}},{key:"add",value:function(t,i){return i&&(t.staticObject=!0),this.calculatePIXI&&(this.dirtyTest||i)&&this.updateObject(t),this.lists[0].push(t),t}},{key:"remove",value:function(t){return this.lists[0].splice(this.lists[0].indexOf(t),1),t}},{key:"cull",value:function(t,i){this.calculatePIXI&&!i&&this.updateObjects();var e=!0,r=!1,a=void 0;try{for(var s,n=this.lists[Symbol.iterator]();!(e=(s=n.next()).done);e=!0){var h=s.value,l=!0,o=!1,u=void 0;try{for(var y,c=h[Symbol.iterator]();!(l=(y=c.next()).done);l=!0){var v=y.value,f=v[this.AABB];v[this.visible]=f.x+f.width>t.x&&f.x<t.x+t.width&&f.y+f.height>t.y&&f.y<t.y+t.height}}catch(t){o=!0,u=t}finally{try{!l&&c.return&&c.return()}finally{if(o)throw u}}}}catch(t){r=!0,a=t}finally{try{!e&&n.return&&n.return()}finally{if(r)throw a}}}},{key:"updateObjects",value:function(){if(this.dirtyTest){var t=!0,i=!1,e=void 0;try{for(var r,a=this.lists[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var s=r.value;if(!s.staticObject){var n=!0,h=!1,l=void 0;try{for(var o,u=s[Symbol.iterator]();!(n=(o=u.next()).done);n=!0){var y=o.value;!y.staticObject&&y[this.dirty]&&(this.updateObject(y),y[this.dirty]=!1)}}catch(t){h=!0,l=t}finally{try{!n&&u.return&&u.return()}finally{if(h)throw l}}}}}catch(t){i=!0,e=t}finally{try{!t&&a.return&&a.return()}finally{if(i)throw e}}}else{var c=!0,v=!1,f=void 0;try{for(var d,x=this.lists[Symbol.iterator]();!(c=(d=x.next()).done);c=!0){var b=d.value;if(!b.staticObject){var p=!0,B=!1,S=void 0;try{for(var g,m=b[Symbol.iterator]();!(p=(g=m.next()).done);p=!0){var w=g.value;w.staticObject||this.updateObject(w)}}catch(t){B=!0,S=t}finally{try{!p&&m.return&&m.return()}finally{if(B)throw S}}}}}catch(t){v=!0,f=t}finally{try{!c&&x.return&&x.return()}finally{if(v)throw f}}}}},{key:"updateObject",value:function(t){var i=t.getLocalBounds();t[this.AABB]=t[this.AABB]||{},t[this.AABB].x=t.x+i.x*t.scale.x,t[this.AABB].y=t.y+i.y*t.scale.y,t[this.AABB].width=i.width*t.scale.x,t[this.AABB].height=i.height*t.scale.y}},{key:"query",value:function(t){var i=[],e=!0,r=!1,a=void 0;try{for(var s,n=this.lists[Symbol.iterator]();!(e=(s=n.next()).done);e=!0){var h=s.value,l=!0,o=!1,u=void 0;try{for(var y,c=h[Symbol.iterator]();!(l=(y=c.next()).done);l=!0){var v=y.value,f=v[this.AABB];f.x+f.width>t.x&&f.x-f.width<t.x+t.width&&f.y+f.height>t.y&&f.y-f.height<t.y+t.height&&i.push(v)}}catch(t){o=!0,u=t}finally{try{!l&&c.return&&c.return()}finally{if(o)throw u}}}}catch(t){r=!0,a=t}finally{try{!e&&n.return&&n.return()}finally{if(r)throw a}}return i}},{key:"queryCallback",value:function(t,i){var e=!0,r=!1,a=void 0;try{for(var s,n=this.lists[Symbol.iterator]();!(e=(s=n.next()).done);e=!0){var h=s.value,l=!0,o=!1,u=void 0;try{for(var y,c=h[Symbol.iterator]();!(l=(y=c.next()).done);l=!0){var v=y.value,f=v[this.AABB];if(f.x+f.width>t.x&&f.x-f.width<t.x+t.width&&f.y+f.height>t.y&&f.y-f.height<t.y+t.height&&i(v))return!0}}catch(t){o=!0,u=t}finally{try{!l&&c.return&&c.return()}finally{if(o)throw u}}}}catch(t){r=!0,a=t}finally{try{!e&&n.return&&n.return()}finally{if(r)throw a}}return!1}},{key:"stats",value:function(){var t=0,i=0,e=!0,r=!1,a=void 0;try{for(var s,n=this.lists[Symbol.iterator]();!(e=(s=n.next()).done);e=!0){s.value.forEach(function(e){t+=e.visible?1:0,i++})}}catch(t){r=!0,a=t}finally{try{!e&&n.return&&n.return()}finally{if(r)throw a}}return{total:i,visible:t,culled:i-t}}}]),t}();i.exports=a},{}],3:[function(t,i,e){"use strict";var r=function(){function t(t,i){for(var e=0;e<i.length;e++){var r=i[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(i,e,r){return e&&t(i.prototype,e),r&&t(i,r),i}}();var a=function(){function t(i){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),i=i||{},this.xSize=i.xSize||i.size||1e3,this.ySize=i.ySize||i.size||1e3,this.AABB=i.type||"AABB",this.spatial=i.spatial||"spatial",this.calculatePIXI=void 0===i.calculatePIXI||i.calculatePIXI,this.visibleText=void 0===i.visibleTest||i.visibleTest,this.simpleTest=void 0===i.simpleTest||i.simpleTest,this.dirtyTest=void 0===i.dirtyTest||i.dirtyTest,this.visible=i.visible||"visible",this.dirty=i.dirty||"dirty",this.width=this.height=0,this.hash={},this.lists=[[]]}return r(t,[{key:"add",value:function(t,i){t[this.spatial]={hashes:[]},this.calculatePIXI&&this.dirtyTest&&(t[this.dirty]=!0),i&&(t.staticObject=!0),this.updateObject(t),this.lists[0].push(t)}},{key:"remove",value:function(t){return this.lists[0].splice(this.list[0].indexOf(t),1),this.removeFromHash(t),t}},{key:"addList",value:function(t,i){var e=!0,r=!1,a=void 0;try{for(var s,n=t[Symbol.iterator]();!(e=(s=n.next()).done);e=!0){var h=s.value;h[this.spatial]={hashes:[]},this.calculatePIXI&&this.dirtyTest&&(h[this.dirty]=!0),i&&(t.staticObject=!0),this.updateObject(h)}}catch(t){r=!0,a=t}finally{try{!e&&n.return&&n.return()}finally{if(r)throw a}}this.lists.push(t)}},{key:"removeList",value:function(t){var i=this;return this.lists.splice(this.lists.indexOf(t),1),t.forEach(function(t){return i.removeFromHash(t)}),t}},{key:"cull",value:function(t,i){var e=this;return i||this.updateObjects(),this.invisible(),this.query(t,this.simpleTest).forEach(function(t){return t[e.visible]=!0}),this.lastBuckets}},{key:"invisible",value:function(){var t=this,i=!0,e=!1,r=void 0;try{for(var a,s=this.lists[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){a.value.forEach(function(i){return i[t.visible]=!1})}}catch(t){e=!0,r=t}finally{try{!i&&s.return&&s.return()}finally{if(e)throw r}}}},{key:"updateObjects",value:function(){var t=this;if(this.dirtyTest){var i=!0,e=!1,r=void 0;try{for(var a,s=this.lists[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var n=a.value,h=!0,l=!1,o=void 0;try{for(var u,y=n[Symbol.iterator]();!(h=(u=y.next()).done);h=!0){var c=u.value;c[this.dirty]&&(this.updateObject(c),c[this.dirty]=!1)}}catch(t){l=!0,o=t}finally{try{!h&&y.return&&y.return()}finally{if(l)throw o}}}}catch(t){e=!0,r=t}finally{try{!i&&s.return&&s.return()}finally{if(e)throw r}}}else{var v=!0,f=!1,d=void 0;try{for(var x,b=this.lists[Symbol.iterator]();!(v=(x=b.next()).done);v=!0){x.value.forEach(function(i){return t.updateObject(i)})}}catch(t){f=!0,d=t}finally{try{!v&&b.return&&b.return()}finally{if(f)throw d}}}}},{key:"updateObject",value:function(t){var i=void 0;if(this.calculatePIXI){var e=t.getLocalBounds();i=t[this.AABB]={x:t.x+e.x*t.scale.x,y:t.y+e.y*t.scale.y,width:e.width*t.scale.x,height:e.height*t.scale.y}}else i=t[this.AABB];var r=t[this.spatial],a=this.getBounds(i),s=a.xStart,n=a.yStart,h=a.xEnd,l=a.yEnd;if(r.xStart!==s||r.yStart!==n||r.xEnd!==h||r.yEnd!==l){r.hashes.length&&this.removeFromHash(t);for(var o=n;o<=l;o++)for(var u=s;u<=h;u++){var y=u+","+o;this.insert(t,y),r.hashes.push(y)}r.xStart=s,r.yStart=n,r.xEnd=h,r.yEnd=l}}},{key:"getBounds",value:function(t){var i=Math.floor(t.x/this.xSize);i=i<0?0:i;var e=Math.floor(t.y/this.ySize);return{xStart:i,yStart:e=e<0?0:e,xEnd:Math.floor((t.x+t.width)/this.xSize),yEnd:Math.floor((t.y+t.height)/this.ySize)}}},{key:"insert",value:function(t,i){this.hash[i]?this.hash[i].push(t):this.hash[i]=[t]}},{key:"removeFromHash",value:function(t){for(var i=t[this.spatial];i.hashes.length;){var e=i.hashes.pop(),r=this.hash[e];r.splice(r.indexOf(t),1)}}},{key:"neighbors",value:function(t){var i=this,e=[];return t[this.spatial].hashes.forEach(function(t){return e=e.concat(i.hash[t])}),e}},{key:"query",value:function(t,i){i=void 0===i||i;for(var e=0,r=[],a=this.getBounds(t),s=a.xStart,n=a.yStart,h=a.xEnd,l=a.yEnd,o=n;o<=l;o++)for(var u=s;u<=h;u++){var y=this.hash[u+","+o];if(y){if(i){var c=!0,v=!1,f=void 0;try{for(var d,x=y[Symbol.iterator]();!(c=(d=x.next()).done);c=!0){var b=d.value,p=b[this.AABB];p.x+p.width>t.x&&p.x<t.x+t.width&&p.y+p.height>t.y&&p.y<t.y+t.height&&r.push(b)}}catch(t){v=!0,f=t}finally{try{!c&&x.return&&x.return()}finally{if(v)throw f}}}else r=r.concat(y);e++}}return this.lastBuckets=e,r}},{key:"queryCallback",value:function(t,i,e){e=void 0===e||e;for(var r=this.getBounds(t),a=r.xStart,s=r.yStart,n=r.xEnd,h=r.yEnd,l=s;l<=h;l++)for(var o=a;o<=n;o++){var u=this.hash[o+","+l];if(u)for(var y=0;y<u.length;y++){var c=u[y];if(e){var v=c.AABB;if(v.x+v.width>v.x&&v.x<v.x+v.width&&v.y+v.height>v.y&&v.y<v.y+v.height&&i(c))return!0}else if(i(c))return!0}}return!1}},{key:"stats",value:function(){var t=0,i=0,e=!0,r=!1,a=void 0;try{for(var s,n=this.lists[Symbol.iterator]();!(e=(s=n.next()).done);e=!0){s.value.forEach(function(e){t+=e.visible?1:0,i++})}}catch(t){r=!0,a=t}finally{try{!e&&n.return&&n.return()}finally{if(r)throw a}}return{total:i,visible:t,culled:i-t}}},{key:"getBuckets",value:function(){return Object.keys(this.hash).length}},{key:"getAverageSize",value:function(){var t=0;for(var i in this.hash)t+=this.hash[i].length;return t/this.getBuckets()}},{key:"getLargest",value:function(){var t=0;for(var i in this.hash)this.hash[i].length>t&&(t=this.hash[i].length);return t}},{key:"getSparseness",value:function(t){for(var i=0,e=0,r=this.getBounds(t),a=r.xStart,s=r.yStart,n=r.xEnd,h=r.yEnd,l=s;l<h;l++)for(var o=a;o<n;o++)i+=this.hash[o+","+l]?1:0,e++;return i/e}}]),t}();i.exports=a},{}]},{},[1]);
